<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Diamond Slots Arcade</title>
<style>
  body {
    background: radial-gradient(circle at center, #1a0033, #000010);
    font-family: 'Orbitron', sans-serif;
    color: #b5b3ff;
    text-align: center;
    overflow-x: hidden;
  }
  h1 {
    font-size: 3em;
    color: #9d7bff;
    text-shadow: 0 0 20px #6f00ff;
    margin-top: 40px;
  }
  .machine {
    margin: 60px auto;
    width: 340px;
    padding: 25px;
    border: 3px solid #4a00ff;
    border-radius: 25px;
    background: rgba(30, 0, 70, 0.7);
    box-shadow: 0 0 40px #6a00ff;
  }
  .reels {
    display: flex;
    justify-content: center;
    gap: 15px;
  }
  .reel {
    background: rgba(0, 0, 40, 0.8);
    color: #00c3ff;
    border: 2px solid #4a00ff;
    border-radius: 10px;
    width: 80px;
    height: 80px;
    font-size: 2.4em;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0 20px #5500ff;
  }
  .btn {
    background: linear-gradient(90deg, #4a00ff, #9b00ff);
    border: none;
    color: white;
    font-size: 1.2em;
    padding: 15px 25px;
    border-radius: 10px;
    cursor: pointer;
    box-shadow: 0 0 20px #6a00ff;
    transition: 0.3s;
  }
  .btn:hover {
    background: linear-gradient(90deg, #6a00ff, #bb00ff);
    box-shadow: 0 0 30px #c300ff;
  }
  .stats {
    margin-top: 20px;
    font-size: 1.1em;
  }
  .jackpot {
    color: #00ffea;
    font-size: 2em;
    text-shadow: 0 0 15px #00fff7;
    animation: flicker 1.5s infinite;
    display: none;
  }
  @keyframes flicker {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }
</style>
</head>
<body>

<h1>üíé Diamond Slots üíé</h1>

<div class="machine">
  <div class="reels">
    <div id="r1" class="reel">üíé</div>
    <div id="r2" class="reel">‚≠ê</div>
    <div id="r3" class="reel">üíé</div>
  </div>
  <br>
  <button class="btn" onclick="spin()">SPIN</button>
  <p class="stats">Diamonds: <span id="diamonds">0</span></p>
  <p class="jackpot" id="jackpotText">üéÜ JACKPOT! üéÜ</p>
</div>

<audio id="spinSound" src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg"></audio>
<audio id="jackpotSound" src="https://actions.google.com/sounds/v1/cartoon/cartoon_boing.ogg"></audio>

<!-- Firebase Setup -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
  import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyB9HCPLU-mcEGZjabMjkkcCqN9h5p6xAi4",
    authDomain: "diamond-slots-5a068.firebaseapp.com",
    projectId: "diamond-slots-5a068",
    storageBucket: "diamond-slots-5a068.firebasestorage.app",
    messagingSenderId: "793464458639",
    appId: "1:793464458639:web:7f709a2166eb49a1a34ffa",
    measurementId: "G-1PKDW5S5J5"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  let diamonds = 0;
  const id = localStorage.getItem('guestID') || 'guest_' + Math.floor(Math.random() * 999999);
  localStorage.setItem('guestID', id);

  async function loadPlayer() {
    const ref = doc(db, "players", id);
    const snap = await getDoc(ref);
    if (snap.exists()) {
      diamonds = snap.data().diamonds;
    } else {
      diamonds = 10000;
      await setDoc(ref, { diamonds });
    }
    document.getElementById("diamonds").textContent = diamonds;
  }

  async function savePlayer() {
    await setDoc(doc(db, "players", id), { diamonds });
  }

  loadPlayer();

  const symbols = ["üíé", "‚≠ê", "üçí", "7Ô∏è‚É£", "üí∞", "üî•"];

  window.spin = async function() {
    document.getElementById("spinSound").play();
    document.getElementById("jackpotText").style.display = "none";

    const r1 = symbols[Math.floor(Math.random() * symbols.length)];
    const r2 = symbols[Math.floor(Math.random() * symbols.length)];
    const r3 = symbols[Math.floor(Math.random() * symbols.length)];

    document.getElementById("r1").textContent = r1;
    document.getElementById("r2").textContent = r2;
    document.getElementById("r3").textContent = r3;

    if (r1 === r2 && r2 === r3) {
      const win = Math.floor(Math.random() * 5000) + 5000;
      diamonds += win;
      document.getElementById("jackpotSound").play();
      document.getElementById("jackpotText").style.display = "block";
    } else {
      diamonds -= 100;
      if (diamonds < 0) diamonds = 0;
    }

    document.getElementById("diamonds").textContent = diamonds;
    await savePlayer();
  };
</script>

</body>
</html>
